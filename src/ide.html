<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Freire Bot - Oy&aacute; Que Legal</title>
  <link href='css/ide.css' rel="stylesheet">
  <script src="js/blockly_compressed.js"></script>
  <script src="js/javascript_compressed.js"></script>
  <script src="js/freireblocks.js"></script>
  <script src="js/msg/en.js"></script>
  <script src="js/main.js"></script>
</head>
<body>
    <img src='imgs/logo_oya.png' id='logooya'>
  <h1>Freirebot - IDE</h1>
  
  <div id='blocklimit'>
  <div id="blocklyDiv" style="height: 100%; width: 100%;"></div>
  </div>

  <xml id="toolbox" style="display: none">
    <category name="Acao">
      <block type="sonar"></block>
      <block type="olhos"></block>
      <block type="cabeca"></block>
      <block type="wheel_r"></block>
      <block type="wheel_l"></block>
    </category>
    <category name="Logica">
      <block type="se"></block>
      <block type="espera"></block>
  </category>
  </xml>
  <div class="btn">
  <button onclick="abrirNoArduino()">Abrir no Arduino</button>
  </div>
  <script>

    var sh = window.innerHeight - 90;
          document.getElementById(
              "blocklimit").style.cssText = 'height: ' + sh + "px; width:100%;"

    
        //carrega blocos
        var fase = parseInt(location.hash.replace('#',''));
        var setres = '';
        if (fase==3) {
          setres = '<block type="for"></block>'
        }
        console.log(fase);

        if (isNaN(fase)) { 
          location.href='index.html';
        }

            fase = '_'+fase;
            document.getElementById('toolbox').innerHTML =
            '<category name="Acao">' +
            '<block type="sonar'+fase+'"></block>' +
            '<block type="olhos'+fase+'"></block>' +
            '<block type="cabeca'+fase+'"></block>' +
            '<block type="wheel_r'+fase+'"></block>' +
            '<block type="wheel_l'+fase+'"></block>' +
            '</category>' +
            '<category name="Logica">' +
            '<block type="se'+fase+'"></block>' +
            '<block type="espera'+fase+'"></block>' +
            setres +
            '</category>';
          
          console.log( document.getElementById('toolbox').innerHTML);


    var demoWorkspace = Blockly.inject('blocklyDiv',
        {media: 'media/',
         toolbox: document.getElementById('toolbox')});
         document.getElementById(":1.label").innerHTML = '<img src="imgs/menu_acao.png">';
         document.getElementById(":2.label").innerHTML = '<img src="imgs/menu_logica.png">';


        var parentBlock = demoWorkspace.newBlock('looping');
        var B = parentBlock;
        parentBlock.moveBy(100, 50)
        parentBlock.initSvg();
        parentBlock.render();

  </script>

  
</body>
</html>
